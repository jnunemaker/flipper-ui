<% if params.key?("error") %>
  <div class="flash flash-error">
    <%= params["error"] %>
  </div>
<% end %>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><%= @feature.key %></h3>
  </div>
  <div class="panel-body">
    <%= @feature.description %>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Boolean</h3>
  </div>
  <div class="panel-body">
    <form action="/features/<%= @feature.key %>/boolean" method="post">
      <input type="submit" name="action" value="Enable" class="btn btn-primary">
      <input type="submit" name="action" value="Disable" class="btn btn-danger">
    </form>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <a href="/features/<%= @feature.key %>/actors" class="btn btn-sm right">Add Actor</a>
    <h3 class="panel-title">Actors</h3>
  </div>
  <div class="panel-body">
    <% if @feature.actors_value.empty? %>
      <div class="blankslate">
        <span class="mega-octicon octicon-person"></span>
        <span class="mega-octicon octicon-squirrel"></span>
        <span class="mega-octicon octicon-zap"></span>
        <h3>No Enabled Actors</h3>
        <p>Enable actors using the form below.</p>
      </div>
    <% else %>
      <ul class="list-group">
        <% @feature.actors_value.each do |item| %>
          <li class="list-group-item">
            <div class="flex-table">
              <div class="flex-table-item flex-table-item-primary">
                <%= item %>
              </div>
              <div class="flex-table-item">
                <form action="/features/<%= @feature.key %>/actors" method="post">
                  <input type="hidden" name="operation" value="disable">
                  <input type="hidden" name="value" value="<%= item %>">
                  <input type="submit" value="Disable" class="btn btn-sm btn-danger">
                </form>
              </div>
            </div>
          </li>
        <% end %>
      </ul>
    <% end %>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Groups</h3>
  </div>
  <div class="panel-body">
    <% if @feature.groups_value.empty? %>
      <div class="blankslate">
        <span class="mega-octicon octicon-organization"></span>
        <span class="mega-octicon octicon-squirrel"></span>
        <span class="mega-octicon octicon-zap"></span>
        <h3>No Enabled Groups</h3>
        <p>Enable groups using the form below.</p>
      </div>
    <% else %>
      <ul class="list-group">
        <% @feature.groups_value.each do |item| %>
          <li class="list-group-item">
            <div class="flex-table">
              <div class="flex-table-item flex-table-item-primary">
                <%= item %>
              </div>
              <div class="flex-table-item">
                <form action="/features/<%= @feature.key %>/group" method="post">
                  <input type="hidden" name="operation" value="disable">
                  <input type="hidden" name="value" value="<%= item %>">
                  <input type="submit" value="Disable" class="btn btn-sm btn-danger">
                </form>
              </div>
            </div>
          </li>
        <% end %>
      </ul>
    <% end %>

    <h3>Add Group</h3>
    <% if @feature.disabled_groups.empty? %>
      <p>All groups are enabled for this feature which means there is nothing to add.</p>
    <% else %>
      <form action="/features/<%= @feature.key %>/group" method="post">
        <input type="hidden" name="operation" value="enable">
        <select name="value">
          <option value="">Select a group...</option>
          <% @feature.disabled_groups.each do |group| %>
            <option value="<%= group.name %>"><%= group.name %></option>
          <% end %>
        </select>
        <input type="submit" value="Enable" class="btn btn-sm btn-primary">
      </form>
    <% end %>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Percentage of Actors</h3>
  </div>
  <div class="panel-body">
    <p>
      Turn this feature on for a percentage of actors (think user, member, account, group, whatever). Enabled checks will consistently be on or off for each actor as long as the percentage increases. Percentage of actors is great for a slow rollout of a new feature to a percentage of actors (users, etc.).
    </p>
    <h3>Presets</h3>
    <form action="/features/<%= @feature.key %>/percentage_of_actors" method="post">
      <div class="btn-group">
        <% [0, 1, 5, 10, 25, 50, 75, 100].each do |number| %>
          <input type="submit" name="value" value="<%= number %>%" class="btn" <% if number == @feature.percentage_of_actors_value %>disabled<% end %>>
        <% end %>
      </div>
    </form>

    <h3>Custom Value</h3>
    <form action="/features/<%= @feature.key %>/percentage_of_actors" method="post">
      <input type="text" name="value" value="<%= @feature.percentage_of_actors_value %>" size="5">
      <input type="submit" name="action" value="Enable" class="btn btn-primary">
    </form>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Percentage of Time</h3>
  </div>
  <div class="panel-body">
    <p>Turn feature on for a percentage of time. Think load testing/dark shipping new features behind the scenes.</p>
    <p><small>Note: Do not use this for anything user-visible as it can cause features to turn on or off each time the user reloads the page.</small></p>

    <h3>Presets</h3>
    <form action="/features/<%= @feature.key %>/percentage_of_time" method="post">
      <div class="btn-group">
        <% [0, 1, 5, 10, 25, 50, 75, 100].each do |number| %>
          <input type="submit" name="value" value="<%= number %>%" class="btn" <% if number == @feature.percentage_of_time_value %>disabled<% end %>>
        <% end %>
      </div>
    </form>

    <h3>Custom Value</h3>
    <form action="/features/<%= @feature.key %>/percentage_of_time" method="post">
      <input type="text" name="value" value="<%= @feature.percentage_of_time_value %>" size="5">
      <input type="submit" name="action" value="Enable" class="btn btn-primary">
    </form>
  </div>
</div>
